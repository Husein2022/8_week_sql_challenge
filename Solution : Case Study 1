1) What is the total amount each customer spent at the restaurant?

SELECT sales.customer_id, SUM(price) AS total_spent
FROM prismatic-grail-337610.dannys_diner.sales
LEFT JOIN prismatic-grail-337610.dannys_diner.menu
ON sales.product_id = menu.product_id
GROUP BY sales.customer_id

OUTPUT - 
Row	customer_id	total_spent	
1      	A         76
2     	B         74
3       C         36


2) How many days has each customer visited the restaurant?

SELECT customer_id, COUNT (DISTINCT order_date) as no_of_days
FROM prismatic-grail-337610.dannys_diner.sales
GROUP BY customer_id

OUTPUT - 
Row	customer_id	no_of_days	
1        A         4
2        B         6
3        C         2


3) What was the first item from the menu purchased by each customer?

SELECT DISTINCT sales.customer_id, sales.order_date, menu.product_name, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS rank
FROM prismatic-grail-337610.dannys_diner.sales
JOIN prismatic-grail-337610.dannys_diner.menu
ON sales.product_id = menu.product_id
ORDER BY rank, customer_id

                OR
                    
 WITH final_table as (
 SELECT DISTINCT sales.customer_id, sales.order_date, menu.product_name, RANK() OVER (PARTITION BY customer_id ORDER BY order_date) AS rank
 FROM prismatic-grail-337610.dannys_diner.sales
 JOIN prismatic-grail-337610.dannys_diner.menu
 ON sales.product_id = menu.product_id
 ORDER BY rank, customer_id
)
SELECT customer_id,product_name
FROM final_table
WHERE rank = 1

OUTPUT - 
Row	customer_id	product_name	
1	     A          curry
2	     A          sushi
3	     B          curry
4	     C          ramen
